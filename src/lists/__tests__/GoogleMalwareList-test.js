jest.autoMockOff();

var Path = require('path');
var ProtoBuf = require('protobufjs');
var GoogleMalwareList = require('../GoogleMalwareList');

var MalwarePatternType = 
  ProtoBuf
    .loadProtoFile(Path.join(__dirname, '..', 'MalwarePatternType.proto'))
    .build('MalwarePatternType');

describe('GoogleMalwareList', function() {
  describe('getNormalizedMetadata', function() {
    it('metadata = normalize(pack(metadata))', function () {
      var metadata = {pattern_type: 2};
      var packed = new MalwarePatternType(metadata).toBuffer();
      var unpacked = GoogleMalwareList.getNormalizedMetadata(packed);

      expect(unpacked.pattern_type).toBe(metadata.pattern_type);
    });
  });
});
